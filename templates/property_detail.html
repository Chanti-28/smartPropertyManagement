{% extends "base.html" %}
{% block content %}
<div class="row">
  <!-- LEFT: Image -->
  <div class="col-md-6 mb-3">
    {% if prop.image_filename %}
      <img src="{{ url_for('uploaded_file', filename=prop.image_filename) }}"
           class="img-fluid rounded shadow-sm mb-3"
           alt="{{ prop.title or 'Property image' }}">
    {% else %}
      <div class="property-detail-placeholder d-flex align-items-center justify-content-center mb-3 bg-light border rounded"
           style="height: 280px;">
        <span class="display-4">üè¢</span>
      </div>
    {% endif %}
  </div>

  <!-- RIGHT: Details -->
  <div class="col-md-6">
    <h2 class="mb-1">{{ prop.title or 'Untitled Property' }}</h2>

    <p class="text-muted mb-2">
      {{ prop.address or '' }}{% if prop.city %}, {{ prop.city }}{% endif %}
    </p>

    <p class="mb-2">
      {% if prop.status %}
        <span class="badge bg-info text-dark me-2">{{ prop.status }}</span>
      {% endif %}

      {% if prop.monthly_rent is not none %}
        <span class="badge bg-light text-dark">
          ‚Ç¨{{ '%.2f'|format(prop.monthly_rent) }}/month
        </span>
      {% else %}
        <span class="badge bg-light text-dark">
          Rent not set
        </span>
      {% endif %}
    </p>

    <p class="mb-3">
      {{ prop.description or 'No description provided for this property.' }}
    </p>

    {% if prop.created_at %}
      <p class="small text-muted">
        Created at {{ prop.created_at.strftime("%Y-%m-%d %H:%M") }}
      </p>
    {% endif %}

    <hr>

    <div class="d-flex flex-wrap gap-2 mt-3">
      <!-- Edit -->
      <a href="{{ url_for('edit_property', property_id=prop.id) }}"
         class="btn btn-primary">
        Edit
      </a>

      <!-- Delete -->
      <form method="post"
            action="{{ url_for('delete_property', property_id=prop.id) }}"
            onsubmit="return confirm('Are you sure you want to delete this property?');">
        <button type="submit" class="btn btn-outline-danger">
          Delete
        </button>
      </form>

      <!-- Back to dashboard -->
      <a href="{{ url_for('index') }}" class="btn btn-outline-secondary">
        Back
      </a>

      <!-- Quick link: public view (only if field exists AND is true) -->
      {% if prop.is_public %}
      <a href="{{ url_for('public_property_detail', property_id=prop.id) }}"
         class="btn btn-outline-primary">
        View Public Page
      </a>
      {% endif %}
    </div>
  </div>
</div>
{% endblock %}
